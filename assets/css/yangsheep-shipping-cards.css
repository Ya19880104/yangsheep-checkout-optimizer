/**
 * 物流選擇卡片樣式
 * 
 * @package YANGSHEEP_Checkout_Optimization
 * @version 1.3.1
 * @since 2026-01-08
 */

/* ===== 物流卡片容器 ===== */
.yangsheep-shipping-cards-wrapper {
    margin-bottom: 20px;
    display: block !important;
}

/* 外層容器：邊框和背景 */
.yangsheep-shipping-cards-container {
    width: 100%;
    border: 2px solid var(--theme-section-border-color, #e0e0e0);
    background-color: var(--section-bg-color, #ffffff);
    border-radius: var(--block-border-radius, 8px);
    /* padding 由 RWD 區塊統一控制 */
    overflow: hidden;
}

/* 內層卡片區：無邊框 */
.yangsheep-shipping-cards {
    background: transparent;
    border: none;
    padding: 0;
}

.yangsheep-shipping-title {
    /* font-size, font-weight, margin 已在 yangsheep-checkout.css 統一區塊標題中定義 */
    color: inherit;
}

/* ===== 物流選項網格佈局 ===== */
.yangsheep-shipping-options {
    display: grid;
    gap: 12px;
    grid-template-columns: 1fr;
}

/* ===== 單張物流卡片 ===== */
.yangsheep-shipping-card {
    display: block;
    position: relative;
    cursor: pointer;
    transition: all 0.2s ease;
    background: transparent !important;
}

.yangsheep-shipping-card input[type="radio"] {
    /* 視覺隱藏但保持可點擊 */
    position: absolute;
    opacity: 0;
    width: 1px;
    height: 1px;
    margin: -1px;
    padding: 0;
    overflow: hidden;
    clip: rect(0, 0, 0, 0);
    border: 0;
}

.yangsheep-shipping-card-inner {
    display: flex;
    align-items: center;
    gap: 15px;
    padding: 16px 20px;
    background: #ffffff;
    border: 2px solid var(--theme-form-field-border-initial-color, #d0d0d0);
    border-radius: var(--block-border-radius, 8px);
    transition: all 0.2s ease;
    overflow: hidden; /* 防止背景色溢出圓角 */
}

/* ===== 勾勾指示器（取代 Radio）===== */
.yangsheep-shipping-radio-indicator {
    flex-shrink: 0;
    width: 22px;
    height: 22px;
    border: 2px solid var(--theme-form-field-border-initial-color, #d0d0d0);
    border-radius: 4px;
    background: #ffffff;
    position: relative;
    transition: all 0.2s ease;
}

/* 勾勾符號 */
.yangsheep-shipping-radio-indicator::after {
    content: '';
    position: absolute;
    top: 3px;
    left: 6px;
    width: 6px;
    height: 11px;
    border: solid #ffffff;
    border-width: 0 2px 2px 0;
    transform: rotate(45deg) scale(0);
    transition: all 0.2s ease;
}

/* ===== 物流資訊 ===== */
.yangsheep-shipping-info {
    flex: 1;
    display: flex;
    flex-direction: column;
    gap: 4px;
}

.yangsheep-shipping-label {
    font-size: 16px;
    font-weight: 500;
    color: #333;
    line-height: 1.4;
}

/* 移除 WooCommerce 預設的價格在 label 內 */
.yangsheep-shipping-label .woocommerce-Price-amount {
    display: none;
}

.yangsheep-shipping-meta {
    font-size: 13px;
    color: #777;
    line-height: 1.3;
}

/* ===== 價格顯示 ===== */
.yangsheep-shipping-price {
    flex-shrink: 0;
    font-size: 16px;
    font-weight: 600;
    color: var(--theme-button-background-initial-color, #6b7a95);
}

.yangsheep-shipping-free {
    color: #28a745;
    font-weight: 600;
}

.yangsheep-shipping-cost {
    color: inherit;
}

/* ===== Hover 狀態 ===== */
.yangsheep-shipping-card:hover .yangsheep-shipping-card-inner {
    border-color: var(--theme-button-background-initial-color, #6b7a95);
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
}

.yangsheep-shipping-card:hover .yangsheep-shipping-radio-indicator {
    border-color: var(--theme-button-background-initial-color, #6b7a95);
}

/* ===== 選中狀態 ===== */
.yangsheep-shipping-card.selected .yangsheep-shipping-card-inner {
    border-color: var(--yangsheep-shipping-border-active, #6b7a95);
    border-width: 3px;
    background: linear-gradient(135deg, rgba(107, 122, 149, 0.08) 0%, rgba(107, 122, 149, 0.03) 100%);
    box-shadow: 0 4px 16px rgba(107, 122, 149, 0.25);
}

.yangsheep-shipping-card.selected .yangsheep-shipping-radio-indicator {
    border-color: var(--yangsheep-shipping-radio-color, #6b7a95);
    background: var(--yangsheep-shipping-radio-color, #6b7a95);
}

.yangsheep-shipping-card.selected .yangsheep-shipping-radio-indicator::after {
    transform: rotate(45deg) scale(1);
}

/* ===== 無可用物流訊息 ===== */
.yangsheep-no-shipping-message {
    padding: 15px;
    background: #fff3cd;
    border: 1px solid #ffc107;
    border-radius: var(--block-border-radius, 8px);
    color: #856404;
    font-size: 14px;
}

/* ===== 處理原訂單表格中的物流區塊 ===== */
/* 隱藏原始 shipping 區塊的 radio 選項，但保留運費行顯示 */
.woocommerce-checkout-review-order-table tr.shipping ul#shipping_method,
#order_review tr.shipping ul#shipping_method,
.ct-order-review tr.shipping ul#shipping_method,
.test tr.shipping ul#shipping_method {
    display: none !important;
}

/* 隱藏單獨的 shipping 選擇區塊 */
.woocommerce-shipping-totals.shipping ul#shipping_method {
    display: none !important;
}

/* 超取相容性規則已移至 yangsheep-compatibility.css */

/* ===== RWD: 響應式網格排列 ===== */

/* 大桌機版 >=1400px：根據數量自動排列 */
@media (min-width: 1400px) {
    /* padding: 20px - 與其他區塊統一 */
    .yangsheep-shipping-cards-container {
        padding: 20px;
    }

    /* 1個選項：100% */
    .yangsheep-shipping-options:has(.yangsheep-shipping-card:only-child) {
        grid-template-columns: 1fr;
    }

    /* 2個選項：左右各一 */
    .yangsheep-shipping-options:has(.yangsheep-shipping-card:nth-child(2):last-child) {
        grid-template-columns: repeat(2, 1fr);
    }

    /* 3個選項：三欄 */
    .yangsheep-shipping-options:has(.yangsheep-shipping-card:nth-child(3):last-child) {
        grid-template-columns: repeat(3, 1fr);
    }

    /* 4個選項：2x2 */
    .yangsheep-shipping-options:has(.yangsheep-shipping-card:nth-child(4):last-child) {
        grid-template-columns: repeat(2, 1fr);
    }

    /* 5個以上：3欄 */
    .yangsheep-shipping-options:has(.yangsheep-shipping-card:nth-child(5)) {
        grid-template-columns: repeat(3, 1fr);
    }
}

/* ===== RWD: 筆電/中桌機版 1000px-1399px ===== */
@media (min-width: 1000px) and (max-width: 1399.9px) {
    /* padding: 20px - 與其他區塊統一 */
    .yangsheep-shipping-cards-container {
        padding: 20px;
    }

    /* 筆電版固定 2 欄 */
    .yangsheep-shipping-options {
        display: grid !important;
        grid-template-columns: repeat(2, 1fr) !important;
    }
}

/* ===== RWD: 平板版 768px-999px ===== */
@media (min-width: 768px) and (max-width: 999.9px) {
    /* padding: 20px 15px - 與其他區塊統一 */
    .yangsheep-shipping-cards-container {
        padding: 20px 15px;
    }

    /* 平板版固定 2 欄 */
    .yangsheep-shipping-options {
        grid-template-columns: repeat(2, 1fr);
    }
}

/* ===== RWD: 手機版 <768px ===== */
@media (max-width: 767.9px) {
    /* padding: 20px 15px - 與其他區塊統一 */
    .yangsheep-shipping-cards-container {
        padding: 20px 15px;
    }

    /* 手機版固定 1 欄 */
    .yangsheep-shipping-options {
        grid-template-columns: 1fr;
        gap: 5px;
    }

    /* 手機版：卡片內部樣式調整 - 橫向排列 */
    .yangsheep-shipping-card-inner {
        display: flex;
        flex-direction: row;
        flex-wrap: nowrap;
        align-items: center;
        padding: 12px;
        gap: 8px;
    }

    /* Radio 指示器固定不壓縮 */
    .yangsheep-shipping-radio-indicator {
        flex-shrink: 0;
        order: 1;
    }

    /* 標題 65% */
    .yangsheep-shipping-info {
        order: 2;
        flex: 0 0 65%;
        max-width: 65%;
        min-width: 0;
        gap: 2px;
        padding-left: 5px;
    }

    /* 價格 25% */
    .yangsheep-shipping-price {
        order: 3;
        flex: 0 0 calc(25% - 30px);
        text-align: right;
        padding-left: 5px;
    }

    .yangsheep-shipping-label {
        font-size: 14px;
    }
}

/* ===== 等高卡片 ===== */
.yangsheep-shipping-options {
    align-items: stretch;
}

.yangsheep-shipping-card {
    display: flex;
    height: 100%;
}

.yangsheep-shipping-card-inner {
    flex: 1;
    display: flex;
    align-items: center;
    height: 100%;
}